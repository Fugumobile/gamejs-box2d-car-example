require.define({"gamejs/display":function(f,a){var g=f("../gamejs").Surface,d=null;a.init=function(){var b=null;e()===null&&(b=document.createElement("canvas"),b.setAttribute("id","gjs-canvas"),document.body.appendChild(b));(b=document.getElementById("gjs-loader"))&&b.parentNode.removeChild(b)};a.setMode=function(b){var m=e();m.width=b[0];m.height=b[1];return c()};a.setCaption=function(b){document.title=b};a._getCanvasOffset=function(){var b=e().getBoundingClientRect();return[b.left,b.top]};var c=
a.getSurface=function(){if(d===null){var b=e();d=new g([b.clientWidth,b.clientHeight]);d._canvas=b}return d},e=function(){var b=null;Array.prototype.slice.call(document.getElementsByTagName("canvas")).every(function(e){if(e.getAttribute("id")=="gjs-canvas")return b=e,!1;return!0});return b}}},["gamejs"]);
require.define({"gamejs/draw":function(f,a){a.line=function(a,d,c,e,b){a=a.context;a.save();a.beginPath();a.strokeStyle=d;a.lineWidth=b||1;a.moveTo(c[0],c[1]);a.lineTo(e[0],e[1]);a.stroke();a.restore()};a.lines=function(a,d,c,e,b){c=c||!1;a=a.context;a.save();a.beginPath();a.strokeStyle=a.fillStyle=d;a.lineWidth=b||1;for(d=0;d<e.length;d++)b=e[d],d===0?a.moveTo(b[0],b[1]):a.lineTo(b[0],b[1]);c&&a.lineTo(e[0][0],e[0][1]);a.stroke();a.restore()};a.circle=function(a,d,c,e,b){if(!e)throw Error("[circle] radius required argument");
if(!c||typeof c!=="array")throw Error("[circle] pos must be given & array"+c);a=a.context;a.save();a.beginPath();a.strokeStyle=a.fillStyle=d;a.lineWidth=b||1;a.arc(c[0],c[1],e,0,2*Math.PI,!0);b===void 0||b===0?a.fill():a.stroke();a.restore()};a.rect=function(a,d,c,e){a=a.context;a.save();a.strokeStyle=a.fillStyle=d;isNaN(e)||e===0?a.fillRect(c.left,c.top,c.width,c.height):(a.lineWidth=e,a.strokeRect(c.left,c.top,c.width,c.height));a.restore()};a.arc=function(a,d,c,e,b,m){a=a.context;a.save();a.strokeStyle=
a.fillStyle=d;a.arc(c.center[0],c.center[1],c.width/2,e*(Math.PI/180),b*(Math.PI/180),!1);isNaN(m)||m===0?a.fill():(a.lineWidth=m,a.stroke());a.restore()};a.polygon=function(a,d,c,e){this.lines(a,d,!0,c,e)}}},[]);
require.define({"gamejs/event":function(f,a){var g=f("./display"),d=f("../gamejs");a.K_UP=38;a.K_DOWN=40;a.K_RIGHT=39;a.K_LEFT=37;a.K_SPACE=32;a.K_BACKSPACE=8;a.K_TAB=9;a.K_ENTER=13;a.K_SHIFT=16;a.K_CTRL=17;a.K_ALT=18;a.K_ESC=27;a.K_0=48;a.K_1=49;a.K_2=50;a.K_3=51;a.K_4=52;a.K_5=53;a.K_6=54;a.K_7=55;a.K_8=56;a.K_9=57;a.K_a=65;a.K_b=66;a.K_c=67;a.K_d=68;a.K_e=69;a.K_f=70;a.K_g=71;a.K_h=72;a.K_i=73;a.K_j=74;a.K_k=75;a.K_l=76;a.K_m=77;a.K_n=78;a.K_o=79;a.K_p=80;a.K_q=81;a.K_r=82;a.K_s=83;a.K_t=84;a.K_u=
85;a.K_v=86;a.K_w=87;a.K_x=88;a.K_y=89;a.K_z=90;a.K_KP1=97;a.K_KP2=98;a.K_KP3=99;a.K_KP4=100;a.K_KP5=101;a.K_KP6=102;a.K_KP7=103;a.K_KP8=104;a.K_KP9=105;a.QUIT=0;a.KEY_DOWN=1;a.KEY_UP=2;a.MOUSE_MOTION=3;a.MOUSE_UP=4;a.MOUSE_DOWN=5;a.MOUSE_WHEEL=6;var c=[];a.get=function(){return c.splice(0,c.length)};a.poll=function(){return c.pop()};a.post=function(a){c.push(a)};a.Event=function(){this.pos=this.button=this.rel=this.key=this.type=null};a.init=function(){function e(b){var a=g._getCanvasOffset();c.push({type:d.event.MOUSE_WHEEL,
pos:[b.clientX-a[0],b.clientY-a[1]],delta:b.detail||-b.wheelDeltaY/40})}document.addEventListener("mousedown",function(b){var a=g._getCanvasOffset();c.push({type:d.event.MOUSE_DOWN,pos:[b.clientX-a[0],b.clientY-a[1]],button:b.button,shiftKey:b.shiftKey,ctrlKey:b.ctrlKey,metaKey:b.metaKey})},!1);document.addEventListener("mouseup",function(b){var a=g._getCanvasOffset();c.push({type:d.event.MOUSE_UP,pos:[b.clientX-a[0],b.clientY-a[1]],button:b.button,shiftKey:b.shiftKey,ctrlKey:b.ctrlKey,metaKey:b.metaKey})},
!1);document.addEventListener("keydown",function(b){var e=b.keyCode||b.which;c.push({type:d.event.KEY_DOWN,key:e,shiftKey:b.shiftKey,ctrlKey:b.ctrlKey,metaKey:b.metaKey});(!b.ctrlKey&&!b.metaKey&&(e>=a.K_LEFT&&e<=a.K_DOWN||e>=a.K_0&&e<=a.K_z||e>=a.K_KP1&&e<=a.K_KP9||e===a.K_SPACE||e===a.K_TAB||e===a.K_ENTER)||e===a.K_ALT||e===a.K_BACKSPACE)&&b.preventDefault()},!1);document.addEventListener("keyup",function(b){c.push({type:d.event.KEY_UP,key:b.keyCode,shiftKey:b.shiftKey,ctrlKey:b.ctrlKey,metaKey:b.metaKey})},
!1);var b=[];document.addEventListener("mousemove",function(a){var e=g._getCanvasOffset(),e=[a.clientX-e[0],a.clientY-e[1]],j=[];b.length&&(j=[b[0]-e[0],b[1]-e[1]]);c.push({type:d.event.MOUSE_MOTION,pos:e,rel:j,buttons:null,timestamp:a.timeStamp});b=e},!1);document.addEventListener("mousewheel",e,!1);document.addEventListener("DOMMouseScroll",e,!1);document.addEventListener("beforeunload",function(){c.push({type:d.event.QUIT})},!1)}}},["gamejs/display","gamejs"]);
require.define({"gamejs/font":function(f,a){var g=f("../gamejs").Surface,d=f("./utils/objects"),c=a.Font=function(a){this.sampleSurface=new g([10,10]);this.sampleSurface.context.font=a;this.sampleSurface.context.textAlign="start";this.sampleSurface.context.textBaseline="bottom";return this};c.prototype.render=function(a,b){var c=this.size(a),c=new g(c),h=c.context;h.save();h.font=this.sampleSurface.context.font;h.textBaseline=this.sampleSurface.context.textBaseline;h.textAlign=this.sampleSurface.context.textAlign;
h.fillStyle=h.strokeStyle=b||"#000000";h.fillText(a,0,c.rect.height,c.rect.width);h.restore();return c};c.prototype.size=function(a){return[this.sampleSurface.context.measureText(a).width,this.fontHeight]};d.accessors(c.prototype,{fontHeight:{get:function(){return this.sampleSurface.context.measureText("M").width*1.5}}})}},["gamejs","gamejs/utils/objects"]);
require.define({"gamejs/http":function(f,a){function g(b){return eval("("+b.responseText+")")}a.Response=function(){this.getResponseHeader=function(){};throw Error("response class not instantiable");};var d=a.ajax=function(b,a,e,c){var e=e||null,d=new XMLHttpRequest;d.open(b,a,!1);c&&d.setRequestHeader("Accept",c);e instanceof Object&&(e=JSON.stringify(e),d.setRequestHeader("Content-Type","application/json"));d.setRequestHeader("X-Requested-With","XMLHttpRequest");d.send(e);return d},c=a.get=function(b){return d("GET",
b)},e=a.post=function(b,a,e){return d("POST",b,a,e)};a.load=function(b){return g(c((window.$g&&$g.ajaxBaseHref||"./")+b))};a.save=function(b,a,c){return g(e((window.$g&&$g.ajaxBaseHref||"./")+b,{payload:a},c))}}},[]);
require.define({"gamejs/image":function(f,a){var g=f("../gamejs"),d={};a.load=function(a){var e;if(typeof a==="string"){if(e=d[a],!e)throw Error('Missing "'+a+'", gamejs.preload() all images before trying to load them.');}else e=a;a=document.createElement("canvas");a.width=e.naturalWidth||e.width;a.height=e.naturalHeight||e.height;a.getContext("2d").drawImage(e,0,0);e.getSize=function(){return[e.naturalWidth,e.naturalHeight]};var b=new g.Surface(e.getSize());b._canvas=a;return b};a.init=function(){};
a.preload=function(a){function e(){h++;h%10===0&&g.log("gamejs.image: preloaded  "+h+" of "+j)}function b(){d[this.gamejsKey]=this;e()}function m(){e();throw Error("Error loading "+this.src);}var h=0,j=0,i;for(i in a)if(!(i.indexOf("png")==-1&&i.indexOf("jpg")==-1&&i.indexOf("gif")==-1)){var f=new Image;f.addEventListener("load",b,!0);f.addEventListener("error",m,!0);f.src=a[i];f.gamejsKey=i;j++}return function(){return j>0?h/j:1}}}},["gamejs"]);
require.define({"gamejs/mask":function(f,a){var g=f("../gamejs"),d=f("./utils/objects");a.fromSurface=function(a,b){for(var b=b&&255-b||255,m=a.getImageData(),d=a.getSize(),g=new c(d),i=0;i<m.length;i+=4){var f=parseInt(i/4/d[0],10),l=parseInt(i/4%d[0],10);m[i+3]>=b&&g.setAt(l,f)}return g};var c=a.Mask=function(a){this.width=a[0];this.height=a[1];this._bits=[];for(a=0;a<this.width;a++){this._bits[a]=[];for(var b=0;b<this.height;b++)this._bits[a][b]=!1}};c.prototype.overlapRect=function(a,b){var c=
this.rect,d=a.rect;b&&d.moveIp(b);if(!d.collideRect(c))return null;var j=Math.max(c.left,d.left),i=Math.max(c.top,d.top);return new g.Rect([j,i],[Math.min(c.right,d.right)-j,Math.min(c.bottom,d.bottom)-i])};c.prototype.overlap=function(a,b){var c=this.overlapRect(a,b);if(c===null)return!1;var d=this.rect,g=a.rect;b&&g.moveIp(b);for(var i=c.top;i<=c.bottom;i++)for(var f=c.left;f<=c.right;f++)if(this.getAt(f-d.left,i-d.top)&&a.getAt(f-g.left,i-g.top))return!0;return!1};c.prototype.overlapArea=function(a,
b){var c=this.overlapRect(a,b);if(c===null)return 0;var d=this.rect,g=a.rect;b&&g.moveIp(b);for(var f=0,k=c.top;k<=c.bottom;k++)for(var l=c.left;l<=c.right;l++)this.getAt(l-d.left,k-d.top)&&a.getAt(l-g.left,k-g.top)&&f++;return f};c.prototype.overlapMask=function(a,b){var d=this.overlapRect(a,b);if(d===null)return 0;var h=this.rect,g=a.rect;b&&g.moveIp(b);for(var f=new c([d.width,d.height]),k=d.top;k<=d.bottom;k++)for(var l=d.left;l<=d.right;l++)this.getAt(l-h.left,k-h.top)&&a.getAt(l-g.left,k-g.top)&&
f.setAt(l,k);return f};c.prototype.setAt=function(a,b){this._bits[a][b]=!0};c.prototype.getAt=function(a,b){a=parseInt(a,10);b=parseInt(b,10);if(a<0||b<0||a>=this.width||b>=this.height)return!1;return this._bits[a][b]};c.prototype.invert=function(){this._bits=this._bits.map(function(a){return a.map(function(a){return!a})})};c.prototype.getSize=function(){return[this.width,this.height]};d.accessors(c.prototype,{rect:{get:function(){return new g.Rect([0,0],[this.width,this.height])}},length:{get:function(){var a=
0;this._bits.forEach(function(b){b.forEach(function(b){b&&a++})});return a}}})}},["gamejs","gamejs/utils/objects"]);
require.define({"gamejs/mixer":function(f,a){function g(a){a instanceof Array||(a=[a]);a.forEach(function(a){d[a.gamejsKey]=a})}f("../gamejs");var d={},c=!1;a.init=function(){var a=Array.prototype.slice.call(document.getElementsByTagName("audio"),0);g(a)};a.preload=function(a){function b(){g(this);f++;f==h&&(c=!1)}function d(){f++;f==h&&(c=!1);throw Error("Error loading "+this.src);}var h=0,f=0,i;for(i in a)if(!(i.indexOf("wav")==-1&&i.indexOf("ogg")==-1&&i.indexOf("webm")==-1)){h++;var k=new Audio;
k.addEventListener("canplay",b,!0);k.addEventListener("error",d,!0);k.src=a[i];k.gamejsKey=i;k.load()}h>0&&(c=!0);return function(){return h>0?f/h:1}};a.isPreloading=function(){return c};a.Sound=function(a){var b;b=typeof a==="string"?d[a]:a;if(!b)throw Error('Missing "'+a+'", gamejs.preload() all audio files before loading');var c=new Audio;c.preload="auto";c.loop="false";c.src=b.src;this.play=function(){(c.ended||c.paused)&&c.play()};this.stop=function(){c.pause()};this.setVolume=function(a){c.volume=
a};this.getVolume=function(){return c.volume};this.getLength=function(){return c.duration};return this}}},["gamejs"]);
require.define({"gamejs/pathfinding/astar":function(f,a){function g(){var a={};this.store=function(b,c){a[b[0]+"-"+b[1]]=c};this.find=function(b){return a[b[0]+"-"+b[1]]};return this}var d=f("../utils/binaryheap").BinaryHeap;a.findRoute=function(a,b,c,h){function f(a){k.push(a);l.store(a.point,a)}function i(b){var c=l.find(b),d=n.length+a.actualDistance(n.point,b);if(!c||c.length>d)c&&k.remove(c),f({point:b,from:n,length:d})}var k=new d(function(b){if(b.score===void 0)b.score=a.estimatedDistance(b.point,
c)+b.length;return b.score}),l=new g;f({point:b,from:null,length:0});for(var b=Date.now(),n=null;k.size()>0&&(!h||Date.now()-b<h);){n=k.pop();if(c[0]===n.point[0]&&c[1]===n.point[1])return n;a.adjacent(n.point).forEach(i)}return null};var c=a.Map=function(){throw Error("not instantiable, this is an interface");};c.prototype.adjacent=function(){};c.prototype.estimatedDistance=function(){};c.prototype.actualDistance=function(){}}},["gamejs/utils/binaryheap"]);
require.define({"gamejs/sprite":function(f,a){f("../gamejs");var g=f("./utils/arrays"),d=a.Sprite=function(){this._groups=[];this._alive=!0;this.rect=this.image=null;return this};d.prototype.kill=function(){this._alive=!1;this._groups.forEach(function(a){a.remove(this)},this)};d.prototype.remove=function(a){a instanceof Array||(a=[a]);a.forEach(function(a){a.remove(this)},this)};d.prototype.add=function(a){a instanceof Array||(a=[a]);a.forEach(function(a){a.add(this)},this)};d.prototype.draw=function(a){a.blit(this.image,
this.rect)};d.prototype.update=function(){};d.prototype.isDead=function(){return!this._alive};var c=a.Group=function(a){this._sprites=[];(a instanceof d||a instanceof Array&&a.length&&a[0]instanceof d)&&this.add(a);return this};c.prototype.update=function(){var a=arguments;this._sprites.forEach(function(c){c.update.apply(c,a)},this)};c.prototype.add=function(a){a instanceof Array||(a=[a]);a.forEach(function(a){this._sprites.push(a);a._groups.push(this)},this)};c.prototype.remove=function(a){a instanceof
Array||(a=[a]);a.forEach(function(a){g.remove(a,this._sprites);g.remove(this,a._groups)},this)};c.prototype.has=function(a){a instanceof Array||(a=[a]);return a.every(function(a){return this._sprites.indexOf(a)!==-1},this)};c.prototype.sprites=function(){return this._sprites};c.prototype.draw=function(){var a=arguments;this._sprites.forEach(function(c){c.draw.apply(c,a)},this)};c.prototype.clear=function(a,c){this._sprites.forEach(function(e){a.blit(c,e.rect)},this)};c.prototype.empty=function(){this._sprites=
[]};c.prototype.collidePoint=function(){var a=Array.prototype.slice.apply(arguments);return this._sprites.filter(function(c){return c.rect.collidePoint.apply(c.rect,a)},this)};c.prototype.forEach=function(){Array.prototype.forEach.apply(this._sprites,arguments)};c.prototype.some=function(){return Array.prototype.some.apply(this._sprites,arguments)};a.spriteCollide=function(a,c,d,g){var g=g||e,d=d||!1,f=[];c.sprites().forEach(function(c){g(a,c)&&(d&&c.kill(),f.push(c))});return f};a.groupCollide=function(a,
c,d,g,f){var d=d||!1,g=g||!1,k=[],l=f||e;a.sprites().forEach(function(a){c.sprites().forEach(function(b){l(a,b)&&(d&&a.kill(),g&&b.kill(),k.push({a:a,b:b}))})});return k};var e=a.collideRect=function(a,c){return a.rect.collideRect(c.rect)};a.collideMask=function(a,c){if(!a.mask||!c.mask)throw Error("Both sprites must have 'mask' attribute set to an gamejs.mask.Mask");return a.mask.overlap(c.mask,[c.rect.left-a.rect.left,c.rect.top-a.rect.top])};a.collideCircle=function(a,c){return a.rect.center[0]*
a.rect.center[0]+a.rect.center[1]*a.rect.center[1]<=(a.radius*a.radius||(a.rect.width*a.rect.width+a.rect.height*a.rect.height)/4)+(c.radius*c.radius||(c.rect.width*c.rect.width+c.rect.height*c.rect.height)/4)}}},["gamejs","gamejs/utils/arrays"]);
require.define({"gamejs/surfacearray":function(f,a){var g=f("../gamejs"),d=f("./utils/objects").accessors;a.blitArray=function(a,e){a.context.putImageData(e.imageData,0,0)};a.SurfaceArray=function(a){this.set=function(a,c,d){a=a*4+c*e[0]*4;b[a]=d[0];b[a+1]=d[1];b[a+2]=d[2];b[a+3]=d[3]===void 0?255:d[3]};this.get=function(a,c){var d=a*4+c*e[0]*4;return[b[d],b[d+1],b[d+2],b[d+3]]};this.surface=null;d(this,{surface:{get:function(){var a=new g.Surface(e);a.context.putImageData(f,0,0);return a}},imageData:{get:function(){return f}}});
this.getSize=function(){return e};var e=null,b=null,f=null;a instanceof Array?(e=a,f=g.display.getSurface().context.createImageData(e[0],e[1]),b=f.data):(e=a.getSize(),b=f=a.getImageData(0,0,e[0],e[1]));return this}}},["gamejs","gamejs/utils/objects"]);
require.define({"gamejs/time":function(f,a){var g={},d={};a.init=function(){Date.now();setInterval(c,10)};a.fpsCallback=function(a,b,c){c=parseInt(1E3/c,10);g[c]=g[c]||[];d[c]=d[c]||0;g[c].push({rawFn:a,callback:function(c){a.apply(b,[c])}})};a.deleteCallback=function(a,c){var c=parseInt(1E3/c,10),d=g[c];d&&(g[c]=d.filter(function(c){if(c.rawFn!==a)return!0;return!1}))};var c=function(){function a(c){c.callback(h)}var c=Date.now(),f;for(f in d){d[f]||(d[f]=c);var h=c-d[f];f<=h&&(d[f]=c,g[f].forEach(a,
this))}}}},[]);
require.define({"gamejs/transform":function(f,a){var g=f("../gamejs").Surface,d=f("./utils/matrix");a.rotate=function(a,e){var b=a.getSize(),f=new g(b),h=a._matrix;a._matrix=d.translate(a._matrix,b[0]/2,b[1]/2);a._matrix=d.rotate(a._matrix,e*Math.PI/180);a._matrix=d.translate(a._matrix,-b[0]/2,-b[1]/2);f.blit(a);a._matrix=h;return f};a.scale=function(a,e){var b=e[0],f=e[1],h=a.getSize(),h=[h[0]*e[0],h[1]*e[1]],h=new g(h);h._matrix=d.scale(h._matrix,[b,f]);h.blit(a);return h};a.flip=function(a,d,b){var f=
a.getSize(),h=new g(f),j=1,i=1,k=0,l=0;d===!0&&(j=-1,k=-f[0]);b===!0&&(i=-1,l=-f[1]);h.context.save();h.context.scale(j,i);h.context.drawImage(a.canvas,k,l);h.context.restore();return h}}},["gamejs","gamejs/utils/matrix"]);require.define({"gamejs/utils/arrays":function(f,a){a.remove=function(a,d){return d.splice(d.indexOf(a),1)}}},[]);
require.define({"gamejs/utils/binaryheap":function(f,a){var g=a.BinaryHeap=function(a){this.content=[];this.scoreFunction=a;return this};g.prototype.push=function(a){this.content.push(a);this.sinkDown(this.content.length-1)};g.prototype.pop=function(){var a=this.content[0],c=this.content.pop();this.content.length>0&&(this.content[0]=c,this.bubbleUp(0));return a};g.prototype.remove=function(a){if(!this.content.some(function(c,e){if(c==a){var b=this.content.pop();e!=this.content.length&&(this.content[e]=
b,this.scoreFunction(b)<this.scoreFunction(a)?this.sinkDown(e):this.bubbleUp(e));return!0}return!1},this))throw Error("Node not found.");};g.prototype.size=function(){return this.content.length};g.prototype.sinkDown=function(a){for(var c=this.content[a];a>0;){var e=Math.floor((a+1)/2)-1,b=this.content[e];if(this.scoreFunction(c)<this.scoreFunction(b))this.content[e]=c,this.content[a]=b,a=e;else break}};g.prototype.bubbleUp=function(a){for(var c=this.content.length,e=this.content[a],b=this.scoreFunction(e);;){var f=
(a+1)*2,g=f-1,j=null;if(g<c){var i=this.scoreFunction(this.content[g]);i<b&&(j=g)}if(f<c&&this.scoreFunction(this.content[f])<(j===null?b:i))j=f;if(j!==null)this.content[a]=this.content[j],this.content[j]=e,a=j;else break}}}},[]);
require.define({"gamejs/utils/math":function(f,a){a.normaliseDegrees=function(a){a%=360;a<0&&(a+=360);return a};a.normaliseRadians=function(a){a%=2*Math.PI;a<0&&(a+=2*Math.PI);return a};a.degrees=function(a){return a*(180/Math.PI)};a.radians=function(a){return a*(Math.PI/180)}}},[]);
require.define({"gamejs/utils/matrix":function(f,a){a.identity=function(){return[1,0,0,1,0,0]};a.add=function(a,c){return[a[0]+c[0],a[1]+c[1],a[2]+c[2],a[3]+c[3],a[4]+c[4],a[5]+c[5],a[6]+c[6]]};var g=a.multiply=function(a,c){return[a[0]*c[0]+a[2]*c[1],a[1]*c[0]+a[3]*c[1],a[0]*c[2]+a[2]*c[3],a[1]*c[2]+a[3]*c[3],a[0]*c[4]+a[2]*c[5]+a[4],a[1]*c[4]+a[3]*c[5]+a[5]]};a.translate=function(a,c,e){return g(a,[1,0,0,1,c,e])};a.rotate=function(a,c){var e=Math.sin(c),b=Math.cos(c);return g(a,[b,e,-e,b,0,0])};
a.rotation=function(a){return Math.atan2(a[1],a[0])};a.scale=function(a,c){return g(a,[c[0],0,0,c[1],0,0])}}},[]);
require.define({"gamejs/utils/objects":function(f,a){a.extend=function(a,e){if(a===void 0)throw Error("unknown subClass");if(e===void 0)throw Error("unknown superClass");var b=new Function;b.prototype=e.prototype;a.prototype=new b;a.prototype.constructor=a;a.superClass=e.prototype;a.superConstructor=e};a.merge=function(){for(var a={},e=arguments.length;e>0;--e){var b=arguments[e-1],d;for(d in b)a[d]=b[d]}return a};var g=a.keys=function(a){if(Object.keys)return Object.keys(a);var e=[],b;for(b in a)Object.prototype.hasOwnProperty.call(a,
b)&&e.push(b);return e},d=a.accessor=function(a,e,b,d){Object.defineProperty!==void 0?Object.defineProperty(a,e,{get:b,set:d}):Object.prototype.__defineGetter__!==void 0&&(a.__defineGetter__(e,b),d&&a.__defineSetter__(e,d))};a.accessors=function(a,e){g(e).forEach(function(b){d(a,b,e[b].get,e[b].set)})}}},[]);
require.define({"gamejs/utils/vectors":function(f,a){var g=f("./math");a.distance=function(a,b){return c(d(a,b))};var d=a.substract=function(a,b){return[a[0]-b[0],a[1]-b[1]]};a.add=function(a,b){return[a[0]+b[0],a[1]+b[1]]};a.multiply=function(a,b){if(typeof b==="number")return[a[0]*b,a[1]*b];return[a[0]*b[0],a[1]*b[1]]};a.divide=function(a,b){if(typeof b==="number")return[a[0]/b,a[1]/b];throw Error("only divide by scalar supported");};var c=a.len=function(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])};
a.unit=function(a){var b=c(a);if(b)return[a[0]/b,a[1]/b];return[0,0]};a.rotate=function(a,b){b=g.normaliseRadians(b);return[a[0]*Math.cos(b)-a[1]*Math.sin(b),a[0]*Math.sin(b)+a[1]*Math.cos(b)]};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]};a.angle=function(a,b){var d=c(a),f=c(b);return d&&f?Math.acos((a[0]*b[0]+a[1]*b[1])/(d*f)):0}}},["gamejs/utils/math"]);
require.define({gamejs:function(f,a){function g(){var a=0,b=0,c=0,d=0;if(arguments.length===2)arguments[0]instanceof Array&&arguments[1]instanceof Array?(a=arguments[0][0],b=arguments[0][1],c=arguments[1][0],d=arguments[1][1]):(a=arguments[0],b=arguments[1]);else if(arguments.length===1&&arguments[0]instanceof Array)a=arguments[0][0],b=arguments[0][1],c=arguments[0][2],d=arguments[0][3];else if(arguments.length===1&&arguments[0]instanceof h)a=arguments[0].left,b=arguments[0].top,c=arguments[0].width,
d=arguments[0].height;else if(arguments.length===4)a=arguments[0],b=arguments[1],c=arguments[2],d=arguments[3];else throw Error("not a valid rectangle specification");return{left:a||0,top:b||0,width:c||0,height:d||0}}var d=f("./gamejs/utils/matrix"),c=f("./gamejs/utils/objects"),e=["info","warn","error","fatal"],b=2;a.setLogLevel=function(a){if(typeof a==="string"&&e.indexOf(a))b=e.indexOf(a);else if(typeof a==="number")b=a;else throw Error("invalid logLevel ",a," Must be one of: ",e);return b};var m=
a.log=function(){var a=Array.prototype.slice.apply(arguments,[0]);a.unshift(Date.now());window.console!==void 0&&console.log.apply&&console.log.apply(console,a)};a.info=function(){b<=e.indexOf("info")&&m.apply(this,arguments)};a.warn=function(){b<=e.indexOf("warn")&&m.apply(this,arguments)};a.error=function(){b<=e.indexOf("error")&&m.apply(this,arguments)};a.fatal=function(){b<=e.indexOf("fatal")&&m.apply(this,arguments)};var h=a.Rect=function(){var a=g.apply(this,arguments);this.left=a.left;this.top=
a.top;this.width=a.width;this.height=a.height;return this};c.accessors(h.prototype,{bottom:{get:function(){return this.top+this.height},set:function(a){this.top=a-this.height}},right:{get:function(){return this.left+this.width},set:function(a){this.left=a-this.width}},center:{get:function(){return[this.left+this.width/2,this.top+this.height/2]},set:function(){var a=g.apply(this,arguments);this.left=a.left-this.width/2;this.top=a.top-this.height/2}}});h.prototype.move=function(){var a=g.apply(this,
arguments);return new h(this.left+a.left,this.top+a.top,this.width,this.height)};h.prototype.moveIp=function(){var a=g.apply(this,arguments);this.left+=a.left;this.top+=a.top};h.prototype.clip=function(a){if(!this.collideRect(a))return new h(0,0,0,0);var b,c,d,e;if(this.left>=a.left&&this.left<a.right)b=this.left;else if(a.left>=this.left&&a.left<this.right)b=a.left;this.right>a.left&&this.right<=a.right?d=this.right-b:a.right>this.left&&a.right<=this.right&&(d=a.right-b);if(this.top>=a.top&&this.top<
a.bottom)c=this.top;else if(a.top>=this.top&&a.top<this.bottom)c=a.top;this.bottom>a.top&&this.bottom<=a.bottom?e=this.bottom-c:a.bottom>this.top&&a.bottom<=this.bottom&&(e=a.bottom-c);return new h(b,c,d,e)};h.prototype.union=function(a){return new h(Math.min(this.left,a.left),Math.min(this.top,a.top),Math.max(this.right,a.right),Math.max(this.bottom,a.bottom))};h.prototype.collidePoint=function(){var a=g.apply(this,arguments);return this.left<=a.left&&a.left<=this.right&&this.top<=a.top&&a.top<=
this.bottom};h.prototype.collideRect=function(a){return!(this.left>a.right||this.right<a.left||this.top>a.bottom||this.bottom<a.top)};h.prototype.collideLine=function(a,b){var c=a[0],d=a[1],e=b[0],f=b[1],g=!0,h=!0,i=!0;[[this.left,this.top],[this.left,this.bottom],[this.right,this.top],[this.right,this.bottom]].map(function(a){return(f-d)*a[0]+(c-e)*a[1]+(e*d-c*f)}).forEach(function(a){a>0?h=!1:a<0?g=!1:a===0&&(i=!1)},this);if((g||h)&&i)return!1;return!(c>this.right&&e>this.right||c<this.left&&e<
this.left||d<this.top&&f<this.top||d>this.bottom&&f>this.bottom)};h.prototype.toString=function(){return["[",this.left,",",this.top,"] [",this.width,",",this.height,"]"].join("")};h.prototype.clone=function(){return new h(this)};var j=a.Surface=function(){var a=g.apply(this,arguments),b=a.left,c=a.top;if(arguments.length==1&&arguments[0]instanceof h)b=a.width,c=a.height;this._matrix=d.identity();this._canvas=document.createElement("canvas");this._canvas.width=b;this._canvas.height=c;this._blitAlpha=
1;return this};j.prototype.blit=function(a,b,c){if(b instanceof h){var b=b.clone(),e=a.getSize();if(!b.width)b.width=e[0];if(!b.height)b.height=e[1]}else b=b&&b instanceof Array&&b.length==2?new h(b,a.getSize()):new h([0,0],a.getSize());c=c instanceof h?c:c&&c instanceof Array&&c.length==2?new h(c,a.getSize()):new h([0,0],a.getSize());if(isNaN(b.left)||isNaN(b.top)||isNaN(b.width)||isNaN(b.height))throw Error("[blit] bad parameters, destination is "+b);this.context.save();e=d.translate(d.identity(),
b.left,b.top);e=d.multiply(e,a._matrix);this.context.transform(e[0],e[1],e[2],e[3],e[4],e[5]);srcRect=a.getRect();this.context.globalAlpha=a._blitAlpha;this.context.drawImage(a.canvas,c.left,c.top,c.width,c.height,0,0,b.width,b.height);this.context.restore();return this.rect.clip(b)};j.prototype.getSize=function(){return[this.canvas.width,this.canvas.height]};j.prototype.getRect=function(){return new h([0,0],this.getSize())};j.prototype.fill=function(a){this.context.save();this.context.fillStyle=
a||"#000000";this.context.fillRect(0,0,this.canvas.width,this.canvas.height);this.context.restore()};j.prototype.clear=function(){var a=this.getSize();this.context.clearRect(0,0,a[0],a[1])};c.accessors(j.prototype,{rect:{get:function(){return this.getRect()}},context:{get:function(){return this._canvas.getContext("2d")}},canvas:{get:function(){return this._canvas}}});j.prototype.clone=function(){var a=new j(this.getRect());a.blit(this);return a};j.prototype.getAlpha=function(){return 1-this._blitAlpha};
j.prototype.setAlpha=function(a){if(!isNaN(a)&&!(a<0||a>1))return this._blitAlpha=1-a,1-this._blitAlpha};j.prototype.getImageData=function(){var a=this.getSize();return this.context.getImageData(0,0,a[0],a[1]).data};a.display=f("./gamejs/display");a.draw=f("./gamejs/draw");a.event=f("./gamejs/event");a.font=f("./gamejs/font");a.http=f("./gamejs/http");a.image=f("./gamejs/image");a.mask=f("./gamejs/mask");a.mixer=f("./gamejs/mixer");a.sprite=f("./gamejs/sprite");a.surfacearray=f("./gamejs/surfacearray");
a.time=f("./gamejs/time");a.transform=f("./gamejs/transform");a.utils={arrays:f("./gamejs/utils/arrays"),objects:f("./gamejs/utils/objects"),matrix:f("./gamejs/utils/matrix"),vectors:f("./gamejs/utils/vectors"),math:f("./gamejs/utils/math")};a.pathfinding={astar:f("./gamejs/pathfinding/astar")};var i=a,k={};a.ready=function(a){function b(){if(!document.body)return window.setTimeout(b,50);d=i.image.preload(k);try{e=i.mixer.preload(k)}catch(a){i.debug("Error loading audio files ",a)}window.setTimeout(c,
50)}function c(){if(d()<1||e()<1)return window.setTimeout(c,100);i.display.init();i.image.init();i.mixer.init();i.event.init();a()}var e=null,d=null;i.time.init();window.setTimeout(b,13);return function(){if(d)return 0.5*d()+0.5*e();return 0.1}};a.preload=function(a){a.forEach(function(a){k[a]=((window.$g&&$g.resourceBaseHref||".")+"/"+a).replace(/\/+/g,"/")},this)}}},["gamejs/utils/matrix","gamejs/utils/objects","gamejs/display","gamejs/draw","gamejs/event","gamejs/font","gamejs/http","gamejs/image",
"gamejs/mask","gamejs/mixer","gamejs/sprite","gamejs/surfacearray","gamejs/time","gamejs/transform","gamejs/utils/arrays","gamejs/utils/vectors","gamejs/utils/math","gamejs/pathfinding/astar"]);
